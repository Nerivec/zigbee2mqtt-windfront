import{r as d,j as a,da as A,u as U,B as R,F as Ye,aV as ze,aQ as Fe,db as De}from"./index-DTLwKrFY.js";import{D as z}from"./DisplayValue-no6ClLSH.js";import{r as Ke}from"./isObject--vsEa_js.js";import{a as Ze,b as Je,r as Qe}from"./_createCompounder-Jh3GrmJ6.js";import{g as D,c as de}from"./index-C7JlGbDK.js";const O=d.memo(({feature:e,deviceValue:r})=>a.jsxs("div",{children:[e.property&&a.jsx("span",{className:"font-bold",children:a.jsx(z,{value:r,name:e.name})}),"unit"in e&&a.jsx("span",{className:"text-xs ms-1",children:e.unit})]})),H=d.memo(e=>a.jsxs("div",{className:"alert alert-warning",role:"alert",children:["Unknown access ",a.jsx("pre",{children:e.feature.access})]})),We=d.memo(e=>{const{feature:{access:r=A.SET,name:t,property:n,value_off:s,value_on:o},deviceValue:i,onChange:u,minimal:c}=e,{t:l}=U("zigbee"),x=d.useCallback(f=>u(n?{[n]:f}:f),[n,u]),m=d.useCallback(async f=>{const g=f.target.checked?o:s;await u(n?{[n]:g}:g)},[o,s,n,u]);if(r&A.SET){const f=i!=null,g=!c||c&&!f;return a.jsxs("div",{children:[g&&a.jsx(R,{className:"btn btn-link",item:s,onClick:x,children:a.jsx(z,{value:s,name:t})}),f?a.jsx("input",{className:"toggle",type:"checkbox",checked:i===o,onChange:m}):a.jsx("span",{className:"tooltip","data-tip":l(b=>b.unknown),children:a.jsx(Ye,{icon:ze})}),g&&a.jsx(R,{className:"btn btn-link",item:o,onClick:x,children:a.jsx(z,{value:o,name:t})})]})}return r&A.STATE?a.jsx(O,{...e}):a.jsx(H,{...e})});function er(e,r){return e==="composite"&&r!==void 0?r.length===0?!0:!r.some(({type:t})=>t==="composite"||t==="list"):!1}function F({feature:e,onChange:r,parentFeatures:t,onRead:n,device:s,deviceState:o,featureWrapperClass:i,minimal:u,endpointSpecific:c,steps:l}){const{type:x,property:m}=e,[f,g]=d.useState({}),{t:b}=U("common"),y=d.useMemo(()=>({...o,...f}),[o,f]),C="features"in e&&e.features||[],j=er(x,t);d.useEffect(()=>{g({})},[s.ieee_address]);const S=d.useCallback(async h=>{if(g(p=>({...p,...h})),!j)if(x==="composite"){const p={...o,...f,...h};await r(m?{[m]:p}:p)}else await r(h)},[o,f,x,m,j,r]),N=d.useCallback(async()=>{const h={...o,...f};await r(m?{[m]:h}:h)},[m,r,f,o]),_=d.useCallback(async h=>{x==="composite"?await n?.(m?{[m]:h}:h):await n?.(h)},[n,x,m]);return a.jsxs(a.Fragment,{children:[C.map(h=>a.jsx(xe,{feature:h,parentFeatures:[...t??[],e],device:s,deviceState:y,onChange:S,onRead:_,featureWrapperClass:i,minimal:u,endpointSpecific:c,steps:l?.[h.name]},D(h))),j&&a.jsx("div",{className:"self-end float-right mt-2",children:a.jsx(R,{className:`btn btn-primary ${u?"btn-sm":""}`,onClick:N,title:e.property??e.name,children:b(h=>h.apply)})})]})}function rr(e){return a.jsx(F,{...e})}var J,ge;function nr(){if(ge)return J;ge=1;function e(r,t,n){return r===r&&(n!==void 0&&(r=r<=n?r:n),t!==void 0&&(r=r>=t?r:t)),r}return J=e,J}var Q,be;function tr(){if(be)return Q;be=1;var e=/\s/;function r(t){for(var n=t.length;n--&&e.test(t.charAt(n)););return n}return Q=r,Q}var W,pe;function sr(){if(pe)return W;pe=1;var e=tr(),r=/^\s+/;function t(n){return n&&n.slice(0,e(n)+1).replace(r,"")}return W=t,W}var ee,ye;function or(){if(ye)return ee;ye=1;var e=sr(),r=Ke(),t=Ze(),n=NaN,s=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,i=/^0o[0-7]+$/i,u=parseInt;function c(l){if(typeof l=="number")return l;if(t(l))return n;if(r(l)){var x=typeof l.valueOf=="function"?l.valueOf():l;l=r(x)?x+"":x}if(typeof l!="string")return l===0?l:+l;l=e(l);var m=o.test(l);return m||i.test(l)?u(l.slice(2),m?2:8):s.test(l)?n:+l}return ee=c,ee}var re,Ce;function ar(){if(Ce)return re;Ce=1;var e=nr(),r=or();function t(n,s,o){return o===void 0&&(o=s,s=void 0),o!==void 0&&(o=r(o),o=o===o?o:0),s!==void 0&&(s=r(s),s=s===s?s:0),e(r(n),s,o)}return re=t,re}var cr=ar();const w=Fe(cr),k=e=>Number.isFinite(e)?e:0,V=([e,r])=>{const t=1-e-r;return[e/r,1,t/r]},ve=e=>{const[r,t,n,s,o,i,u,c,l]=e,x=o*l-i*c,m=-(s*l-i*u),f=s*c-o*u,g=r*x+t*m+n*f;if(Math.abs(g)<1e-9||!Number.isFinite(g))return[0,0,0,0,0,0,0,0,0];const b=1/g;return[k(x*b),k((n*c-t*l)*b),k((t*i-n*o)*b),k(m*b),k((r*l-n*u)*b),k((n*s-r*i)*b),k(f*b),k((t*u-r*c)*b),k((r*o-t*s)*b)]},ir=(e,r)=>[e[0]*r[0]+e[1]*r[1]+e[2]*r[2],e[3]*r[0]+e[4]*r[1]+e[5]*r[2],e[6]*r[0]+e[7]*r[1]+e[8]*r[2]],lr=e=>{const[r,t,n]=V(e.red),[s,o,i]=V(e.green),[u,c,l]=V(e.blue),[x,m,f]=V(e.white),b=ve([r,s,u,t,o,c,n,i,l]),[y,C,j]=ir(b,[x,m,f]),S=[r*y,s*C,u*j,t*y,o*C,c*j,n*y,i*C,l*j];return{toXyz:S,toRgb:ve(S)}},ur=e=>{const{threshold:r,slope:t,exponent:n,offset:s}=e,o=c=>c<=r?t*c:(1+s)*c**(1/n)-s,i=o(r);return{encode:o,decode:c=>c<=i?c/t:((c+s)/(1+s))**n}},mr={encode:e=>w(e,0,1),decode:e=>w(e,0,1)},$e=ur({threshold:.0031308,slope:12.92,exponent:2.4,offset:.055}),fr={name:"Zigbee / CIE 1931",red:[.7347,.2653],green:[.2738,.7174],blue:[.1666,.0089],white:[1/3,1/3],gammaCorrection:mr},dr={name:"Philips Hue",red:[.675,.322],green:[.4091,.518],blue:[.167,.04],white:[1/3,1/3],gammaCorrection:$e},xr={name:"Philips Hue Living Colors",red:[.704,.296],green:[.2151,.7106],blue:[.138,.08],white:[1/3,1/3],gammaCorrection:$e},K={cie1931:fr,philipsHue:dr,philipsLivingColors:xr},he={};for(const e in K){const r=K[e];he[r.name]=lr(r)}const qe=(e,r)=>e==="Philips"?r.includes("LivingColors")||r.includes("Bloom")||r.includes("Aura")||r.includes("Iris")?"philipsLivingColors":"philipsHue":"cie1931",Ue=(e,r)=>{const t=[0,0,0];for(let n=0;n<3;n++){t[n]=0;for(let s=0;s<3;s++)t[n]+=r[n*3+s]*e[s]}return t},Oe=(e,r,t,n=10)=>{if(r<=0)return 0;let s=1;for(let o=0;o<n;o++){const i=Math.max(...He(e,r,s,t));if(i<=0||!Number.isFinite(i))return 0;s=s/i}return s},_e=(e,r,t,n)=>{const s=[n.gammaCorrection.decode(e),n.gammaCorrection.decode(r),n.gammaCorrection.decode(t)],{toXyz:o}=he[n.name];return Ue(s,o)},hr=(e,r,t,n)=>{const{toRgb:s}=he[n.name],o=Ue([e,r,t],s);return[n.gammaCorrection.encode(o[0]),n.gammaCorrection.encode(o[1]),n.gammaCorrection.encode(o[2])]},He=(e,r,t,n)=>{const s=1-e-r;return hr(t/r*e,t,t/r*s,n)},B=(e,r,t,n)=>{if(e/=255,r/=255,t/=255,e<1e-12&&r<1e-12&&t<1e-12){const[c,l,x]=_e(1,1,1,n),m=c+l+x;return[c/m,l/m,0]}const[s,o,i]=_e(e,r,t,n),u=s+o+i;return[s/u,o/u,o]},gr=(e,r,t,n)=>{if(r<=0)return[0,0,0];const s=t??Oe(e,r,n,10);if(s<=0||!Number.isFinite(s))return[0,0,0];const[o,i,u]=He(e,r,s,n);return[w(o*255,0,255),w(i*255,0,255),w(u*255,0,255)]},G=(e,r,t)=>{e/=255,r/=255,t/=255;const n=Math.max(e,r,t),s=n-Math.min(e,r,t),o=s?(n===e?(r-t)/s+(r<t?6:0):n===r?2+(t-e)/s:4+(e-r)/s)*60:0,i=n?s/n*100:0,u=n*100;return[w(o,0,360),w(i,0,100),w(u,0,100)]},br=(e,r,t)=>{r/=100,t/=100;const n=~~(e/60),s=e/60-n,o=t*(1-r),i=t*(1-r*s),u=t*(1-r*(1-s)),c=n%6,l=[t,i,o,o,u,t][c]*255,x=[u,t,t,i,o,o][c]*255,m=[o,o,u,t,t,i][c]*255;return[w(l,0,255),w(x,0,255),w(m,0,255)]},P=(e,r,t)=>`#${Math.round(e).toString(16).padStart(2,"0")}${Math.round(r).toString(16).padStart(2,"0")}${Math.round(t).toString(16).padStart(2,"0")}`,pr=e=>{const r=Number.parseInt(e.slice(1),16);return[r>>16&255,r>>8&255,r&255]},q=(e,r,t)=>{switch(r){case"color_xy":{const{x:n=t.white[0],y:s=t.white[1],Y:o=Oe(n,s===0?t.white[1]:s,t,10)}=e,i=s===0?[255,255,255]:gr(n,s,o,t);return{color_rgb:i,color_hs:G(...i),color_xy:[n,s,o],hex:P(...i)}}case"color_hs":{const{hue:n=0,saturation:s=0,value:o=100}=e,i=br(n,s,o);return{color_rgb:i,color_hs:[n,s,o],color_xy:B(...i,t),hex:P(...i)}}case"color_rgb":{const{r:n=255,g:s=255,b:o=255}=e;return{color_rgb:[n,s,o],color_hs:G(n,s,o),color_xy:B(n,s,o,t),hex:P(n,s,o)}}case"hex":{const n=e.hex,s=pr(n);return{color_rgb:s,color_hs:G(...s),color_xy:B(...s,t),hex:n}}default:{const n=[255,255,255];return{color_rgb:n,color_hs:G(...n),color_xy:B(...n,t),hex:P(...n)}}}},je=(e,r)=>{switch(r){case"color_xy":return{x:e.color_xy[0],y:e.color_xy[1]};case"color_hs":return{hue:e.color_hs[0],saturation:e.color_hs[1]};case"color_rgb":return{r:e.color_rgb[0],g:e.color_rgb[1],b:e.color_rgb[2]};case"hex":return{hex:e.hex}}},Ve=e=>`${e[0].toFixed(3)}, ${e[1].toFixed(3)}, ${e[2].toFixed(3)}`,Y=e=>`${e[0].toFixed(2)}Â°, ${e[1].toFixed(2)}%, ${e[2].toFixed(2)}%`,Be=e=>`${e[0].toFixed(0)}, ${e[1].toFixed(0)}, ${e[2].toFixed(0)}`,Ge=e=>e,Se=e=>({color_xy:Ve(e.color_xy),color_hs:Y(e.color_hs),color_rgb:Be(e.color_rgb),hex:Ge(e.hex)}),yr=e=>{const r=e.match(/-?\d+(?:\.\d+)?/gu)??[];return Array.from({length:3}).map((t,n)=>+(r[n]??0))},Cr=e=>{const r=e.match(/-?\d+(?:\.\d+)?/gu)??[];return Array.from({length:3}).map((t,n)=>w(+(r[n]??0),0,n?100:360))},vr=e=>{const r=e.match(/-?\d+(?:\.\d+)?/gu)??[];return Array.from({length:3}).map((t,n)=>w(+(r[n]??0),0,255))},ne=(e,r,t)=>{switch(r){case"color_xy":{const n=yr(e);return q({x:n[0],y:n[1]},"color_xy",t)}case"color_hs":{const n=Cr(e);return q({hue:n[0],saturation:n[1]},"color_hs",t)}case"color_rgb":{const n=vr(e);return q({r:n[0],g:n[1],b:n[2]},"color_rgb",t)}case"hex":return q({hex:e},"hex",t)}},_r="linear-gradient(to right, white, transparent)",jr="linear-gradient(to right, rgb(255, 0, 0), rgb(255, 255, 0), rgb(0, 255, 0), rgb(0, 255, 255), rgb(0, 0, 255), rgb(255, 0, 255), rgb(255, 0, 0))",L=d.memo(({label:e,...r})=>a.jsxs("label",{className:"input",children:[e,a.jsx("input",{type:"text",className:"grow",...r})]})),Pe=d.memo(({onChange:e,value:r={},format:t,gamut:n,minimal:s})=>{const[o,i]=d.useState(n in K?n:"cie1931"),u=K[o],[c,l]=d.useState(q(r,t,u)),[x,m]=d.useState(Se(c)),[f,g]=d.useState({color_rgb:!1,color_hs:!1,color_xy:!1,hex:!1});d.useEffect(()=>{const h=q(r,t,u);l(h),m(Se(h))},[r,t,u]),d.useEffect(()=>{i(n)},[n]),d.useEffect(()=>{if(!f.color_xy){const h=Ve(c.color_xy);m(p=>({...p,color_xy:h}))}},[f.color_xy,c.color_xy]),d.useEffect(()=>{if(!f.color_hs){const h=Y(c.color_hs);m(p=>({...p,color_hs:h}))}},[f.color_hs,c.color_hs]),d.useEffect(()=>{if(!f.color_rgb){const h=Be(c.color_rgb);m(p=>({...p,color_rgb:h}))}},[f.color_rgb,c.color_rgb]),d.useEffect(()=>{if(!f.hex){const h=Ge(c.hex);m(p=>({...p,hex:h}))}},[f.hex,c.hex]);const b=d.useCallback(h=>{if(h.target.value){const p=Array.from(c.color_hs);p[1]=h.target.valueAsNumber;const E=Y(p);m(I=>({...I,color_hs:E})),l(ne(E,"color_hs",u))}},[c.color_hs,u]),y=d.useCallback(h=>{if(h.target.value){const p=Array.from(c.color_hs),E=p[1];p[1]=E===0?100:E,p[0]=h.target.valueAsNumber;const I=Y(p);m(Z=>({...Z,color_hs:I})),l(ne(I,"color_hs",u))}},[c.color_hs,u]),C=d.useCallback(h=>{const{value:p,name:E}=h.target;m(I=>({...I,[E]:p})),l(ne(p,E,u))},[u]),j=d.useCallback(h=>{g(p=>({...p,[h.target.name]:!0}))},[]),S=d.useCallback(h=>{g(p=>({...p,[h.target.name]:!1})),e(je(c,t))},[c,t,e]),N=d.useCallback(()=>{e(je(c,t))},[c,t,e]),_=d.useMemo(()=>`hsl(${c.color_hs[0]}, 100%, 50%)`,[c.color_hs[0]]);return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"flex flex-row flex-wrap gap-3 items-center",children:a.jsx("div",{className:`w-full${s?" max-w-xs":""}`,children:a.jsx("input",{type:"range",min:0,max:100,value:c.color_hs[1],className:`range [--range-bg:transparent] [--range-fill:0] w-full${s?" range-xs ":""}`,style:{backgroundImage:_r,backgroundColor:_},onChange:b,onTouchEnd:N,onMouseUp:N,onKeyUp:N})})}),a.jsx("div",{className:"flex flex-row flex-wrap gap-3 items-center",children:a.jsx("div",{className:`w-full${s?" max-w-xs":""}`,children:a.jsx("input",{type:"range",min:0,max:360,value:c.color_hs[0],className:`range [--range-bg:transparent] [--range-fill:0] w-full${s?" range-xs ":""}`,style:{backgroundImage:jr},onChange:y,onTouchEnd:N,onMouseUp:N,onKeyUp:N})})}),!s&&a.jsxs("div",{className:"flex flex-row flex-wrap gap-2 justify-around",children:[a.jsx(L,{label:"hex",name:"hex",value:x.hex,onChange:C,onFocus:j,onBlur:S}),a.jsx(L,{label:"rgb",name:"color_rgb",value:x.color_rgb,onChange:C,onFocus:j,onBlur:S}),a.jsx(L,{label:"hsv",name:"color_hs",value:x.color_hs,onChange:C,onFocus:j,onBlur:S}),a.jsx(L,{label:"xyY",name:"color_xy",value:x.color_xy,onChange:C,onFocus:j,onBlur:S})]})]})}),Sr=d.memo(e=>{const{device:r,deviceValue:t,feature:{name:n,features:s,property:o},onChange:i,minimal:u}=e,c=d.useMemo(()=>{const m={},f=t!=null&&typeof t=="object"?t:{};for(const g of s){const b=Number.parseFloat(f[g.name]);m[g.name]=Number.isNaN(b)?0:b}return m},[t,s]),l=d.useMemo(()=>r.definition?qe(r.definition.vendor,r.definition.description):"cie1931",[r.definition]),x=d.useCallback(async m=>{await i({[o??"color"]:m})},[o,i]);return a.jsx(Pe,{onChange:x,value:c,format:n,minimal:u,gamut:l})}),Tr={position:[0,25,50,75,100].map(e=>({value:e,name:`${e}`})),tilt:[0,25,50,75,100].map(e=>({value:e,name:`${e}`}))};function Ar(e){return a.jsx(F,{...e,steps:Tr})}function X(e){return typeof e!="object"}const Le=d.memo(e=>{const{onChange:r,values:t,value:n,minimal:s}=e,{t:o}=U("common"),i=X(n),u=d.useCallback(async c=>{const l=t.find(x=>X(x)?x===c.target.value:x.value===Number.parseInt(c.target.value,10));await r(l)},[t,r]);return s?a.jsxs("select",{className:"select",onChange:u,value:(i?n:n?.value)??"",children:[a.jsx("option",{value:"",disabled:!0,children:o(c=>c.select_value)}),t.map(c=>{const l=X(c);return a.jsx("option",{value:l?c:c.value,children:l?c:c.name},l?c:c.name)})]}):a.jsx("div",{className:"flex flex-row flex-wrap gap-1",children:t.map(c=>{const l=X(c),x=l?c===n:c.value===(i?n:n?.value);return a.jsx(R,{className:`btn btn-outline btn-primary btn-sm join-item${x?" btn-active":""}`,onClick:r,item:l?c:c.value,title:l?`${c}`:c.description,children:l?a.jsx(z,{value:c,name:""}):c.name},l?c:c.name)})})}),Nr=6,Er=d.memo(e=>{const{onChange:r,feature:{access:t=A.SET,values:n,property:s},deviceValue:o,minimal:i}=e;return t&A.SET?a.jsx(Le,{onChange:u=>r(s?{[s]:u}:u),values:n,value:o!=null&&(typeof o=="string"||typeof o=="number"||typeof o=="object")?o:"",minimal:i||n.length>Nr}):t&A.STATE?a.jsx(O,{...e}):a.jsx(H,{...e})});function wr(e){return a.jsx(F,{...e})}const te=e=>e>0?Array(e).fill("#ffffff"):[],Rr=d.memo(e=>{const{device:r,minimal:t,onChange:n,feature:{length_min:s,length_max:o,property:i},deviceValue:u}=e,{t:c}=U("common"),[l,x]=d.useState(te(s)),[m,f]=d.useState(!1),[g,b]=d.useState(!1);d.useEffect(()=>{u&&Array.isArray(u)?x(de(u,s,o,_=>te(_))):x(te(s))},[u,s,o]),d.useEffect(()=>{f(l.length<o),b(l.length>s)},[l,s,o]);const y=d.useMemo(()=>r.definition?qe(r.definition.vendor,r.definition.description):"cie1931",[r.definition]),C=d.useCallback((_,h)=>{x(p=>{const E=Array.from(p);return E[_]=h,E})},[]),j=d.useCallback(()=>{x(_=>[..._,"#ffffff"])},[]),S=d.useCallback(_=>{x(h=>{const p=Array.from(h);return p.splice(_,1),p})},[]),N=d.useCallback(async()=>{await n({[i??"gradient"]:l})},[l,i,n]);return a.jsxs(a.Fragment,{children:[l.map((_,h)=>a.jsxs("div",{className:"flex flex-row flex-wrap gap-2 items-center",children:[a.jsx(Pe,{onChange:p=>(C(h,p.hex),Promise.resolve()),value:{hex:_},format:"hex",gamut:y,minimal:t}),g&&a.jsx(R,{item:h,className:"btn btn-sm btn-error",onClick:S,children:"-"})]},`${_}-${h}`)),m&&a.jsx("div",{className:"flex flex-row flex-wrap gap-2",children:a.jsx(R,{className:"btn btn-sm btn-success",onClick:j,children:"+"})}),a.jsx("div",{children:a.jsx(R,{className:`btn btn-primary ${t?"btn-sm":""}`,onClick:N,children:c(_=>_.apply)})})]})}),kr={brightness:[0,25,50,75,100].map(e=>({value:De(e,[0,100],[0,255]),name:`${e}%`})),color_temp:[1e3,2e3,3e3,4e3,5e3,6500].map(e=>({value:1e6/e,name:`${e}K`}))};function Ir(e){return a.jsx(F,{...e,steps:kr})}function Mr(e){return e!==void 0?e.length===0?!0:!e.some(({type:r})=>r==="composite"||r==="list"):!1}const $=(e,r)=>e>0?Array(e).fill(r==="composite"?{}:""):[],Fr=d.memo(e=>{const{t:r}=U("common"),{feature:t,minimal:n,parentFeatures:s,onChange:o,onRead:i,deviceValue:u,device:c,featureWrapperClass:l}=e,{property:x,access:m=A.SET,item_type:f,length_min:g,length_max:b}=t,[y,C]=d.useState($(g??0,f.type)),[j,S]=d.useState(!1),[N,_]=d.useState(!1),h=Mr(s);d.useEffect(()=>{if(u)if(Array.isArray(u))C(de(u,g,b,v=>$(v,f.type)));else if(x&&typeof u=="object"){const v=u[x];C(v?de(v,g,b,T=>$(T,f.type)):$(g??0,f.type))}else C($(g??0,f.type));else C($(g??0,f.type))},[u,x,f.type,g,b]),d.useEffect(()=>{S(b!==void 0&&b>0?y.length<b:!0),_(g!==void 0&&g>0?y.length>g:!0)},[y,g,b]);const p=d.useCallback(async(v,T)=>{const M=Array.from(y);typeof v=="object"&&v!=null&&(v={...y[T],...v}),M[T]=v??"",C(M),h||await o(x?{[x]:M}:M)},[y,x,h,o]),E=d.useCallback(()=>C(v=>[...v,f.type==="composite"?{}:""]),[f.type]),I=d.useCallback(async v=>{const T=Array.from(y);T.splice(v,1),C(T),h||await o(x?{[x]:T}:T)},[y,x,h,o]),Z=d.useCallback(async()=>{await o(x?{[x]:y}:y)},[x,o,y]);if(m&A.SET)return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"list bg-base-100",children:y.map((v,T)=>a.jsxs(d.Fragment,{children:[a.jsx(xe,{feature:f,device:c,deviceState:v,onChange:M=>p(M,T),featureWrapperClass:l,parentFeatures:[...s,t],minimal:n}),N&&a.jsx(R,{item:T,className:"btn btn-sm btn-error btn-square",onClick:I,children:"-"})]},`${D(f)}-${T}`))}),j&&a.jsx("div",{className:"flex flex-row flex-wrap gap-2",children:a.jsx(R,{className:"btn btn-sm btn-success btn-square",onClick:E,children:"+"})}),h&&a.jsx("div",{children:a.jsx(R,{className:`btn btn-primary ${n?"btn-sm":""}`,onClick:Z,children:r(v=>v.apply)})})]});if(m&A.STATE){const v=Array.isArray(u)?u:x&&typeof u=="object"&&u!=null?u[x]:void 0;return"type"in f&&f.type==="composite"&&Array.isArray(v)?a.jsx("div",{className:"list bg-base-100",children:v.map((T,M)=>a.jsx(xe,{feature:f,device:c,deviceState:T??{},onChange:()=>Promise.resolve(),onRead:i,featureWrapperClass:l,parentFeatures:[...s,t],minimal:n},`${D(f)}-${M}`))}):a.jsx(O,{...e})}return a.jsx(H,{...e})});function $r(e){return a.jsx(F,{...e})}const qr=d.memo(e=>{const{onChange:r,value:t,min:n,max:s,unit:o,steps:i,minimal:u,...c}=e,[l,x]=d.useState(t),m=n!=null&&s!=null;d.useEffect(()=>{x(t)},[t]);const f=d.useCallback(b=>{x(b.target.value?b.target.valueAsNumber:"")},[]),g=d.useCallback(async b=>{b.target.validationMessage||await r(l===""?null:l)},[l,r]);return a.jsxs("div",{className:"flex flex-row flex-wrap gap-3 items-center",children:[!u&&i?a.jsx(Le,{values:i,onChange:r,value:l}):null,m?a.jsxs("div",{className:"w-full max-w-xs",children:[a.jsx("input",{min:n,max:s,type:"range",className:"range range-xs range-primary validator",value:l,onChange:f,onTouchEnd:g,onMouseUp:g,onKeyUp:g,...c}),a.jsxs("div",{className:"flex justify-between px-1 mt-1 text-xs",children:[a.jsx("span",{children:n}),u&&a.jsx("span",{children:l}),a.jsx("span",{children:s})]})]}):null,(!u||!m)&&a.jsxs("label",{className:"input",children:[a.jsx("input",{type:"number",className:"grow validator",value:l,onChange:f,onBlur:g,min:n,max:s,...c}),o]})]})}),Ur=d.memo(e=>{const{feature:{presets:r,access:t=A.SET,property:n,unit:s,value_max:o,value_min:i,value_step:u},deviceValue:c,steps:l,onChange:x,minimal:m}=e;return t&A.SET?a.jsx(qr,{onChange:async f=>{await x(n?{[n]:f}:f)},value:typeof c=="number"?c:"",min:i,max:o,step:u,steps:r?.length?r:l,unit:s,minimal:m}):t&A.STATE?a.jsx(O,{...e}):a.jsx(H,{...e})});function Or(e){return a.jsx(F,{...e})}const Hr=d.memo(e=>{const{onChange:r,value:t,...n}=e,[s,o]=d.useState(t);return d.useEffect(()=>{o(t)},[t]),a.jsx("input",{type:"text",className:"input validator",value:s,onChange:i=>o(i.target.value),onBlur:i=>!i.target.validationMessage&&r(s),...n})}),Vr=d.memo(e=>{const{feature:{access:r=A.SET,property:t},deviceValue:n,onChange:s}=e;return r&A.SET?a.jsx(Hr,{onChange:async o=>{await s(t?{[t]:o}:o)},value:n!=null?typeof n=="string"?n:JSON.stringify(n):""}):r&A.STATE?a.jsx(O,{...e}):a.jsx(H,{...e})});function xe({feature:e,device:r,deviceState:t,steps:n,onRead:s,onChange:o,featureWrapperClass:i,minimal:u,endpointSpecific:c,parentFeatures:l}){const x=e.property?t[e.property]:t,m=D(e),f={device:r,deviceValue:x,onChange:o,onRead:s,featureWrapperClass:i,minimal:u,endpointSpecific:c,parentFeatures:l},g={feature:e,onRead:s,deviceValue:x,parentFeatures:l,endpointSpecific:c};switch(e.type){case"binary":return a.jsx(i,{...g,children:a.jsx(We,{feature:e,...f},m)},m);case"numeric":return a.jsx(i,{...g,children:a.jsx(Ur,{feature:e,...f,steps:n},m)},m);case"list":return e.name==="gradient"&&e.length_min!=null&&e.length_max!=null?a.jsx(i,{...g,children:a.jsx(Rr,{feature:e,...f},m)},m):a.jsx(i,{...g,children:a.jsx(Fr,{feature:e,...f},m)},m);case"text":return a.jsx(i,{...g,children:a.jsx(Vr,{feature:e,...f},m)},m);case"enum":return a.jsx(i,{...g,children:a.jsx(Er,{feature:e,...f},m)},m);case"light":return a.jsx(Ir,{feature:e,...f,deviceState:t},m);case"switch":return a.jsx(Or,{feature:e,...f,deviceState:t},m);case"cover":return a.jsx(Ar,{feature:e,...f,deviceState:t},m);case"lock":return a.jsx($r,{feature:e,...f,deviceState:t},m);case"climate":return a.jsx(rr,{feature:e,...f,deviceState:t},m);case"fan":return a.jsx(wr,{feature:e,...f,deviceState:t},m);case"composite":return e.name==="color_xy"||e.name==="color_hs"?a.jsx(i,{...g,children:a.jsx(Sr,{feature:e,...f},m)},m):a.jsx(i,{...g,children:a.jsx("div",{className:"list bg-base-100",children:a.jsx(F,{feature:e,...f,deviceState:e.property?t[e.property]:t},m)})},m);default:return console.error("Unsupported feature",e),a.jsx(i,{...g,children:a.jsx("pre",{children:JSON.stringify(e,null,4)})},m)}}var se,Te;function Br(){if(Te)return se;Te=1;function e(r,t,n){var s=-1,o=r.length;t<0&&(t=-t>o?0:o+t),n=n>o?o:n,n<0&&(n+=o),o=t>n?0:n-t>>>0,t>>>=0;for(var i=Array(o);++s<o;)i[s]=r[s+t];return i}return se=e,se}var oe,Ae;function Gr(){if(Ae)return oe;Ae=1;var e=Br();function r(t,n,s){var o=t.length;return s=s===void 0?o:s,!n&&s>=o?t:e(t,n,s)}return oe=r,oe}var ae,Ne;function Xe(){if(Ne)return ae;Ne=1;var e="\\ud800-\\udfff",r="\\u0300-\\u036f",t="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",s=r+t+n,o="\\ufe0e\\ufe0f",i="\\u200d",u=RegExp("["+i+e+s+o+"]");function c(l){return u.test(l)}return ae=c,ae}var ce,Ee;function Pr(){if(Ee)return ce;Ee=1;function e(r){return r.split("")}return ce=e,ce}var ie,we;function Lr(){if(we)return ie;we=1;var e="\\ud800-\\udfff",r="\\u0300-\\u036f",t="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",s=r+t+n,o="\\ufe0e\\ufe0f",i="["+e+"]",u="["+s+"]",c="\\ud83c[\\udffb-\\udfff]",l="(?:"+u+"|"+c+")",x="[^"+e+"]",m="(?:\\ud83c[\\udde6-\\uddff]){2}",f="[\\ud800-\\udbff][\\udc00-\\udfff]",g="\\u200d",b=l+"?",y="["+o+"]?",C="(?:"+g+"(?:"+[x,m,f].join("|")+")"+y+b+")*",j=y+b+C,S="(?:"+[x+u+"?",u,m,f,i].join("|")+")",N=RegExp(c+"(?="+c+")|"+S+j,"g");function _(h){return h.match(N)||[]}return ie=_,ie}var le,Re;function Xr(){if(Re)return le;Re=1;var e=Pr(),r=Xe(),t=Lr();function n(s){return r(s)?t(s):e(s)}return le=n,le}var ue,ke;function Yr(){if(ke)return ue;ke=1;var e=Gr(),r=Xe(),t=Xr(),n=Je();function s(o){return function(i){i=n(i);var u=r(i)?t(i):void 0,c=u?u[0]:i.charAt(0),l=u?e(u,1).join(""):i.slice(1);return c[o]()+l}}return ue=s,ue}var me,Ie;function zr(){if(Ie)return me;Ie=1;var e=Yr(),r=e("toUpperCase");return me=r,me}var fe,Me;function Dr(){if(Me)return fe;Me=1;var e=Qe(),r=zr(),t=e(function(n,s,o){return n+(o?" ":"")+r(s)});return fe=t,fe}var Kr=Dr();const rn=Fe(Kr);export{xe as F,rn as s};
