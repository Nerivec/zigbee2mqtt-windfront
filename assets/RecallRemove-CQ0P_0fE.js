import{r as c,u as L,g as B,a as G,D as H,aR as J,s as _,j as l,B as q,y as Q,a5 as R}from"./index-DTLwKrFY.js";import{D as X}from"./DashboardFeatureWrapper-BN_abfxH.js";import{F as Y}from"./startCase-Cc7wIt65.js";import{g as Z}from"./index-C7JlGbDK.js";import{I as M}from"./InputField-fj8dQezf.js";import{_ as I}from"./extends-CF3RwP-h.js";import{_ as ee,c as E,g as ae,a as ne,b as w,v as te,d as W,u as oe,e as se}from"./react-select.esm-Bdw18Log.js";const ge=c.memo(({sourceIdx:a,target:e,deviceState:s})=>{const{t:i}=L("scene"),[r,o]=c.useState(0),[m,f]=c.useState(""),b=c.useMemo(()=>B(e),[e]),v=G(H(t=>J(e)?t.deviceScenesFeatures[a][e.ieee_address]??[]:[])),n=c.useCallback(async t=>{await _(a,`${e.friendly_name}/set`,t)},[a,e]),d=c.useCallback(async()=>{const t={ID:r,name:m||`Scene ${r}`};await _(a,`${e.friendly_name}/set`,{scene_store:t})},[a,e,r,m]),C=c.useMemo(()=>r>=0&&r<=255&&!b.find(t=>t.id===r),[r,b]);return l.jsxs(l.Fragment,{children:[l.jsx("h2",{className:"text-lg font-semibold",children:i(t=>t.add_update_header)}),l.jsxs("div",{className:"mb-3",children:[l.jsx(M,{name:"scene_id",label:i(t=>t.scene_id),type:"number",value:r,onChange:t=>!!t.target.value&&o(t.target.valueAsNumber),min:0,max:255,required:!0}),l.jsx(M,{name:"scene_name",label:i(t=>t.scene_name),type:"text",value:m,placeholder:`Scene ${r}`,onChange:t=>f(t.target.value),required:!0}),v.length>0&&l.jsx("div",{className:"card card-border bg-base-100 shadow my-2",children:l.jsx("div",{className:"card-body p-4",children:v.map(t=>l.jsx(Y,{feature:t,device:e,deviceState:s,onChange:n,featureWrapperClass:X,minimal:!0,parentFeatures:[]},Z(t)))})})]}),l.jsx(q,{disabled:!C,onClick:d,className:"btn btn-primary",children:i(t=>t.store)})]})});var ie=["allowCreateWhileLoading","createOptionPosition","formatCreateLabel","isValidNewOption","getNewOptionData","onCreateOption","options","onChange"],T=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",s=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0,r=String(e).toLowerCase(),o=String(i.getOptionValue(s)).toLowerCase(),m=String(i.getOptionLabel(s)).toLowerCase();return o===r||m===r},y={formatCreateLabel:function(e){return'Create "'.concat(e,'"')},isValidNewOption:function(e,s,i,r){return!(!e||s.some(function(o){return T(e,o,r)})||i.some(function(o){return T(e,o,r)}))},getNewOptionData:function(e,s){return{label:s,value:e,__isNew__:!0}}};function re(a){var e=a.allowCreateWhileLoading,s=e===void 0?!1:e,i=a.createOptionPosition,r=i===void 0?"last":i,o=a.formatCreateLabel,m=o===void 0?y.formatCreateLabel:o,f=a.isValidNewOption,b=f===void 0?y.isValidNewOption:f,v=a.getNewOptionData,n=v===void 0?y.getNewOptionData:v,d=a.onCreateOption,C=a.options,t=C===void 0?[]:C,S=a.onChange,u=ee(a,ie),$=u.getOptionValue,x=$===void 0?ne:$,k=u.getOptionLabel,D=k===void 0?ae:k,p=u.inputValue,A=u.isLoading,V=u.isMulti,O=u.value,F=u.name,g=c.useMemo(function(){return b(p,E(O),t,{getOptionValue:x,getOptionLabel:D})?n(p,m(p)):void 0},[m,n,D,x,p,b,t,O]),z=c.useMemo(function(){return(s||!A)&&g?r==="first"?[g].concat(w(t)):[].concat(w(t),[g]):t},[s,r,A,g,t]),K=c.useCallback(function(h,N){if(N.action!=="select-option")return S(h,N);var P=Array.isArray(h)?h:[h];if(P[P.length-1]===g){if(d)d(p);else{var j=n(p,p),U={action:"create-option",name:F,option:j};S(te(V,[].concat(w(E(O)),[j]),j),U)}return}S(h,N)},[n,p,V,F,g,d,S,O]);return W(W({},u),{},{options:z,onChange:K})}var le=c.forwardRef(function(a,e){var s=oe(a),i=re(s);return c.createElement(se,I({ref:e},i))}),ce=le;const me=c.memo(({onSceneSelected:a,scenes:e=[],disabled:s})=>{const{t:i}=L("scene"),r=c.useMemo(()=>e.map(o=>({value:`${o.id}`,label:`${o.id}: ${o.name}`})).sort((o,m)=>o.label.localeCompare(m.label)),[e]);return l.jsx("fieldset",{className:"fieldset",children:l.jsx(ce,{unstyled:!0,placeholder:i(o=>o.scene_name),"aria-label":i(o=>o.scene_name),options:r,isSearchable:!0,isDisabled:s,onChange:o=>{o!=null&&a(Number.parseInt(o.value,10))},className:"min-w-64",classNames:Q})})}),he=c.memo(({sourceIdx:a,target:e})=>{const{t:s}=L(["scene","common"]),[i,r]=c.useState({id:0,name:"Scene 0"}),o=c.useMemo(()=>B(e),[e]),m=c.useCallback(n=>{const d=o.find(C=>C.id===n);r(d!==void 0?d:{id:n,name:`Scene ${n}`})},[o]),f=c.useCallback(async()=>await _(a,`${e.friendly_name}/set`,{scene_recall:i.id}),[a,e.friendly_name,i.id]),b=c.useCallback(async()=>await _(a,`${e.friendly_name}/set`,{scene_remove:i.id}),[a,e.friendly_name,i.id]),v=c.useCallback(async()=>await _(a,`${e.friendly_name}/set`,{scene_remove_all:""}),[a,e.friendly_name]);return l.jsxs(l.Fragment,{children:[l.jsx("h2",{className:"text-lg font-semibold",children:s(n=>n.manage_scenes_header)}),l.jsx("div",{className:"mb-3",children:l.jsx(me,{onSceneSelected:m,scenes:o})}),l.jsxs("div",{className:"join join-horizontal w-full",children:[l.jsx(q,{disabled:!i,onClick:f,className:"btn btn-success join-item flex-1",children:s(n=>n.recall)}),l.jsx(R,{disabled:!i,onClick:b,className:"btn btn-error join-item flex-1",title:s(n=>n.remove,{ns:"common"}),modalDescription:s(n=>n.dialog_confirmation_prompt,{ns:"common"}),modalCancelLabel:s(n=>n.cancel,{ns:"common"}),children:s(n=>n.remove,{ns:"common"})}),l.jsx(R,{onClick:v,className:"btn btn-error btn-outline join-item flex-1",title:s(n=>n.remove_all),modalDescription:s(n=>n.dialog_confirmation_prompt,{ns:"common"}),modalCancelLabel:s(n=>n.cancel,{ns:"common"}),children:s(n=>n.remove_all)})]})]})});export{ge as A,he as R};
