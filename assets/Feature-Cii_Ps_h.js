import{r as f,j as o,b8 as j,b as F,C as A,F as ie,b9 as ze,au as Re,ba as Le,O as De}from"./index-BFQ_Rrcw.js";import{D as L}from"./DisplayValue-ZtlRXdX7.js";import{r as Pe}from"./isObject--vsEa_js.js";import{r as Xe,a as Ke,b as Je}from"./_createCompounder-BUW0VzD-.js";import{g as Ee,c as ue,a as Ye}from"./index-BWCKKOXu.js";const q=f.memo(({feature:e,deviceValue:r})=>o.jsxs("div",{children:[e.property&&o.jsx("span",{className:"font-bold",children:o.jsx(L,{value:r,name:e.name})}),"unit"in e&&o.jsx("span",{className:"text-xs ms-1",children:e.unit})]})),M=f.memo(e=>o.jsxs("div",{className:"alert alert-warning",role:"alert",children:["Unknown access ",o.jsx("pre",{children:e.feature.access})]})),Ze=f.memo(e=>{const{feature:{access:r=j.SET,name:n,property:t,value_off:a,value_on:s},deviceValue:i,onChange:m,minimal:l}=e,{t:c}=F("zigbee"),h=f.useCallback(x=>m(t?{[t]:x}:x),[t,m]),u=f.useCallback(x=>{const g=x.target.checked?s:a;m(t?{[t]:g}:g)},[s,a,t,m]);if(r&j.SET){const x=i!=null,g=!l||l&&!x;return o.jsxs("div",{children:[g&&o.jsx(A,{className:"btn btn-link",item:a,onClick:h,children:o.jsx(L,{value:a,name:n})}),x?o.jsx("input",{className:"toggle",type:"checkbox",checked:i===s,onChange:u}):o.jsx("span",{className:"tooltip","data-tip":c(y=>y.unknown),children:o.jsx(ie,{icon:ze})}),g&&o.jsx(A,{className:"btn btn-link",item:s,onClick:h,children:o.jsx(L,{value:s,name:n})})]})}return r&j.STATE?o.jsx(q,{...e}):o.jsx(M,{...e})});function Qe(e,r){if(e==="composite"&&r!==void 0){if(r.length===0)return!0;if(r.length===1){const n=r[0].type;return n!=null&&n!=="composite"&&n!=="list"}}return!1}function E({feature:e,onChange:r,parentFeatures:n,onRead:t,device:a,deviceState:s,featureWrapperClass:i,minimal:m,endpointSpecific:l,steps:c}){const{type:h,property:u}=e,[x,g]=f.useState({}),{t:y}=F("common"),v=f.useMemo(()=>({...s,...x}),[s,x]),S="features"in e&&e.features||[],N=Qe(h,n);f.useEffect(()=>{g({})},[a.ieee_address]);const d=f.useCallback(p=>{g($=>({...$,...p})),N||r(h==="composite"&&u?{[u]:{...x,...p}}:p)},[x,h,u,N,r]),b=f.useCallback(()=>{const p={...s,...x};r(u?{[u]:p}:p)},[u,r,x,s]),_=f.useCallback(p=>{t?.(h==="composite"&&u?{[u]:p}:p)},[t,h,u]);return o.jsxs(o.Fragment,{children:[S.map(p=>o.jsx(He,{feature:p,parentFeatures:n??[],device:a,deviceState:v,onChange:d,onRead:_,featureWrapperClass:i,minimal:m,endpointSpecific:l,steps:c?.[p.name]},Ee(p))),N&&o.jsx("div",{className:"self-end float-right",children:o.jsx(A,{className:`btn btn-primary ${m?"btn-sm":""}`,onClick:b,children:y(p=>p.apply)})})]})}function We(e){return o.jsx(E,{...e})}var P,me;function en(){if(me)return P;me=1;function e(r,n,t){return r===r&&(t!==void 0&&(r=r<=t?r:t),n!==void 0&&(r=r>=n?r:n)),r}return P=e,P}var X,fe;function nn(){if(fe)return X;fe=1;var e=/\s/;function r(n){for(var t=n.length;t--&&e.test(n.charAt(t)););return t}return X=r,X}var K,xe;function rn(){if(xe)return K;xe=1;var e=nn(),r=/^\s+/;function n(t){return t&&t.slice(0,e(t)+1).replace(r,"")}return K=n,K}var J,he;function tn(){if(he)return J;he=1;var e=rn(),r=Pe(),n=Xe(),t=NaN,a=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,i=/^0o[0-7]+$/i,m=parseInt;function l(c){if(typeof c=="number")return c;if(n(c))return t;if(r(c)){var h=typeof c.valueOf=="function"?c.valueOf():c;c=r(h)?h+"":h}if(typeof c!="string")return c===0?c:+c;c=e(c);var u=s.test(c);return u||i.test(c)?m(c.slice(2),u?2:8):a.test(c)?t:+c}return J=l,J}var Y,de;function sn(){if(de)return Y;de=1;var e=en(),r=tn();function n(t,a,s){return s===void 0&&(s=a,a=void 0),s!==void 0&&(s=r(s),s=s===s?s:0),a!==void 0&&(a=r(a),a=a===a?a:0),e(r(t),a,s)}return Y=n,Y}var on=sn();const R=Re(on),an=[.412453,.35758,.180423,.212671,.71516,.072169,.019334,.119193,.950227],cn=[3.2404813432005266,-1.5371515162713183,-.49853632616888777,-.9692549499965684,1.8759900014898907,.041555926558292815,.05564663913517715,-.20404133836651123,1.0573110696453443],ke=.42,we=.0031308,Ie=12.92,D=.055,H=e=>e<=we?Ie*e:(1+D)*e**ke-D,ln=1/ke,un=H(we),mn=1/Ie,Z=e=>e<=un?e*mn:((e+D)/(1+D))**ln,Fe=(e,r)=>{const n=[0,0,0];for(let t=0;t<3;t++){n[t]=0;for(let a=0;a<3;a++)n[t]+=r[t*3+a]*e[a]}return n},ge=(e,r,n)=>{const t=[Z(e),Z(r),Z(n)];return Fe(t,an)},fn=(e,r,n)=>{const t=Fe([e,r,n],cn);return[H(t[0]),H(t[1]),H(t[2])]},$e=(e,r,n)=>{const t=1-e-r;return fn(n/r*e,n,n/r*t)},qe=(e,r,n=10)=>{let t=1;for(let a=0;a<n;a++){const s=Math.max(...$e(e,r,t));t=t/s}return t},B=(e,r,n)=>{if(e/=255,r/=255,n/=255,e<1e-12&&r<1e-12&&n<1e-12){const[m,l,c]=ge(1,1,1),h=m+l+c;return[m/h,l/h,0]}const[t,a,s]=ge(e,r,n),i=t+a+s;return[t/i,a/i,a]},xn=(e,r,n)=>{n===void 0&&(n=qe(e,r));const[t,a,s]=$e(e,r,n);return[R(t*255,0,255),R(a*255,0,255),R(s*255,0,255)]},V=(e,r,n)=>{e/=255,r/=255,n/=255;const t=Math.max(e,r,n),a=t-Math.min(e,r,n),s=a?(t===e?(r-n)/a+(r<n?6:0):t===r?2+(n-e)/a:4+(e-r)/a)*60:0,i=t?a/t*100:0,m=t*100;return[R(s,0,360),R(i,0,100),R(m,0,100)]},hn=(e,r,n)=>{r/=100,n/=100;const t=~~(e/60),a=e/60-t,s=n*(1-r),i=n*(1-r*a),m=n*(1-r*(1-a)),l=t%6,c=[n,i,s,s,m,n][l]*255,h=[m,n,n,i,s,s][l]*255,u=[s,s,m,n,n,i][l]*255;return[R(c,0,255),R(h,0,255),R(u,0,255)]},O=(e,r,n)=>{const[t,a,s]=[e,r,n].map(i=>Math.round(i).toString(16).padStart(2,"0"));return`#${t}${a}${s}`},dn=e=>(e=e.slice(1),Array.from({length:3}).map((r,n)=>Number.parseInt(e.slice(n*2,n*2+2),16))),I=(e,r)=>{switch(r){case"color_xy":{const{x:n=.313,y:t=.329,Y:a=qe(n,t===0?.329:t)}=e,s=t===0?[255,255,255]:xn(n,t,a);return{color_rgb:s,color_hs:V(...s),color_xy:[n,t,a],hex:O(...s)}}case"color_hs":{const{hue:n=0,saturation:t=0}=e,a=100,s=hn(n,t,a);return{color_rgb:s,color_hs:[n,t,a],color_xy:B(...s),hex:O(...s)}}case"color_rgb":{const{r:n=255,g:t=255,b:a=255}=e;return{color_rgb:[n,t,a],color_hs:V(n,t,a),color_xy:B(n,t,a),hex:O(n,t,a)}}case"hex":{const n=e.hex,t=dn(n);return{color_rgb:t,color_hs:V(...t),color_xy:B(...t),hex:n}}default:{const n=[255,255,255];return{color_rgb:n,color_hs:V(...n),color_xy:B(...n),hex:O(...n)}}}},be=(e,r)=>{switch(r){case"color_xy":return{x:e.color_xy[0],y:e.color_xy[1]};case"color_hs":return{hue:e.color_hs[0],saturation:e.color_hs[1]};case"color_rgb":return{r:e.color_rgb[0],g:e.color_rgb[1],b:e.color_rgb[2]};case"hex":return{hex:e.hex}}},Me=e=>`${e[0].toFixed(3)}, ${e[1].toFixed(3)}, ${e[2].toFixed(3)}`,z=e=>`${e[0].toFixed(2)}Â°, ${e[1].toFixed(2)}%, ${e[2].toFixed(2)}%`,Be=e=>`${e[0].toFixed(0)}, ${e[1].toFixed(0)}, ${e[2].toFixed(0)}`,Ve=e=>e,pe=e=>({color_xy:Me(e.color_xy),color_hs:z(e.color_hs),color_rgb:Be(e.color_rgb),hex:Ve(e.hex)}),gn=e=>{const r=e.match(/\d+(\.\d+)?/gu)??[];return Array.from({length:3}).map((n,t)=>+(r[t]??0))},bn=e=>{const r=e.match(/\d+(\.\d+)?/gu)??[];return Array.from({length:3}).map((n,t)=>R(+(r[t]??0),0,t?100:360))},pn=e=>{const r=e.match(/\d+(\.\d+)?/gu)??[];return Array.from({length:3}).map((n,t)=>R(+(r[t]??0),0,255))},Q=(e,r)=>{switch(r){case"color_xy":{const n=gn(e);return I({x:n[0],y:n[1]},"color_xy")}case"color_hs":{const n=bn(e);return I({hue:n[0],saturation:n[1]},"color_hs")}case"color_rgb":{const n=pn(e);return I({r:n[0],g:n[1],b:n[2]},"color_rgb")}case"hex":return I({hex:e},"hex")}},yn="linear-gradient(to right, white, transparent)",_n="linear-gradient(to right, rgb(255, 0, 0), rgb(255, 255, 0), rgb(0, 255, 0), rgb(0, 255, 255), rgb(0, 0, 255), rgb(255, 0, 255), rgb(255, 0, 0))",U=f.memo(({label:e,...r})=>o.jsxs("label",{className:"input",children:[e,o.jsx("input",{type:"text",className:"grow",...r})]})),Oe=f.memo(e=>{const{onChange:r,value:n={},format:t,minimal:a}=e,[s,i]=f.useState(I(n,t)),[m,l]=f.useState(pe(s)),[c,h]=f.useState({color_rgb:!1,color_hs:!1,color_xy:!1,hex:!1});f.useEffect(()=>{const d=I(n,t);i(d),l(pe(d))},[n,t]),f.useEffect(()=>{if(!c.color_xy){const d=Me(s.color_xy);l(b=>({...b,color_xy:d}))}},[c.color_xy,s.color_xy]),f.useEffect(()=>{if(!c.color_hs){const d=z(s.color_hs);l(b=>({...b,color_hs:d}))}},[c.color_hs,s.color_hs]),f.useEffect(()=>{if(!c.color_rgb){const d=Be(s.color_rgb);l(b=>({...b,color_rgb:d}))}},[c.color_rgb,s.color_rgb]),f.useEffect(()=>{if(!c.hex){const d=Ve(s.hex);l(b=>({...b,hex:d}))}},[c.hex,s.hex]);const u=f.useCallback(d=>{if(d.target.value){const b=Array.from(s.color_hs);b[1]=d.target.valueAsNumber;const _=z(b);l(p=>({...p,color_hs:_})),i(Q(_,"color_hs"))}},[s.color_hs]),x=f.useCallback(d=>{if(d.target.value){const b=Array.from(s.color_hs),_=b[1];b[1]=_===0?100:_,b[0]=d.target.valueAsNumber;const p=z(b);l($=>({...$,color_hs:p})),i(Q(p,"color_hs"))}},[s.color_hs]),g=f.useCallback(d=>{const{value:b,name:_}=d.target;l(p=>({...p,[_]:b})),i(Q(b,_))},[]),y=f.useCallback(d=>{h(b=>({...b,[d.target.name]:!0}))},[]),v=f.useCallback(d=>{h(b=>({...b,[d.target.name]:!1})),r(be(s,t))},[s,t,r]),S=f.useCallback(()=>{r(be(s,t))},[s,t,r]),N=f.useMemo(()=>`hsl(${s.color_hs[0]}, 100%, 50%)`,[s.color_hs[0]]);return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"flex flex-row flex-wrap gap-3 items-center",children:o.jsx("div",{className:`w-full${a?" max-w-xs":""}`,children:o.jsx("input",{type:"range",min:0,max:100,value:s.color_hs[1],className:`range [--range-bg:transparent] [--range-fill:0] w-full${a?" range-xs ":""}`,style:{backgroundImage:yn,backgroundColor:N},onChange:u,onTouchEnd:S,onMouseUp:S,onKeyUp:S})})}),o.jsx("div",{className:"flex flex-row flex-wrap gap-3 items-center",children:o.jsx("div",{className:`w-full${a?" max-w-xs":""}`,children:o.jsx("input",{type:"range",min:0,max:360,value:s.color_hs[0],className:`range [--range-bg:transparent] [--range-fill:0] w-full${a?" range-xs ":""}`,style:{backgroundImage:_n},onChange:x,onTouchEnd:S,onMouseUp:S,onKeyUp:S})})}),!a&&o.jsxs("div",{className:"flex flex-row flex-wrap gap-2 justify-around",children:[o.jsx(U,{label:"hex",name:"hex",value:m.hex,onChange:g,onFocus:y,onBlur:v}),o.jsx(U,{label:"rgb",name:"color_rgb",value:m.color_rgb,onChange:g,onFocus:y,onBlur:v}),o.jsx(U,{label:"hsv",name:"color_hs",value:m.color_hs,onChange:g,onFocus:y,onBlur:v}),o.jsx(U,{label:"xyY",name:"color_xy",value:m.color_xy,onChange:g,onFocus:y,onBlur:v})]})]})}),vn=f.memo(e=>{const{deviceValue:r,feature:{name:n,features:t,property:a},onChange:s,minimal:i}=e,m=f.useMemo(()=>{const c={},h=r!=null&&typeof r=="object"?r:{};for(const u of t){const x=Number.parseFloat(h[u.name]);c[u.name]=Number.isNaN(x)?0:x}return c},[r,t]),l=f.useCallback(c=>s({[a??"color"]:c}),[a,s]);return o.jsx(Oe,{onChange:l,value:m,format:n,minimal:i})}),Cn={position:[0,25,50,75,100].map(e=>({value:e,name:`${e}`})),tilt:[0,25,50,75,100].map(e=>({value:e,name:`${e}`}))};function jn(e){return o.jsx(E,{...e,steps:Cn})}function G(e){return typeof e!="object"}const Ue=f.memo(e=>{const{onChange:r,values:n,value:t,minimal:a}=e,{t:s}=F("common"),i=G(t),m=f.useCallback(l=>{const c=n.find(h=>G(h)?h===l.target.value:h.value===Number.parseInt(l.target.value,10));r(c)},[n,r]);return a?o.jsxs("select",{className:"select",onChange:m,value:(i?t:t?.value)??"",children:[o.jsx("option",{value:"",disabled:!0,children:s(l=>l.select_value)}),n.map(l=>{const c=G(l);return o.jsx("option",{value:c?l:l.value,children:c?l:l.name},c?l:l.name)})]}):o.jsx("div",{className:"flex flex-row flex-wrap gap-1",children:n.map(l=>{const c=G(l),h=c?l===t:l.value===(i?t:t?.value);return o.jsx(A,{className:`btn btn-outline btn-primary btn-sm join-item${h?" btn-active":""}`,onClick:u=>r(u),item:c?l:l.value,title:c?`${l}`:l.description,children:c?o.jsx(L,{value:l,name:""}):l.name},c?l:l.name)})})}),Sn=6,Tn=f.memo(e=>{const{onChange:r,feature:{access:n=j.SET,values:t,property:a},deviceValue:s,minimal:i}=e;return n&j.SET?o.jsx(Ue,{onChange:m=>r(a?{[a]:m}:m),values:t,value:s!=null&&(typeof s=="string"||typeof s=="number"||typeof s=="object")?s:"",minimal:i||t.length>Sn}):n&j.STATE?o.jsx(q,{...e}):o.jsx(M,{...e})});function Nn(e){return o.jsx(E,{...e})}const W=e=>e>0?Array(e).fill("#ffffff"):[],An=f.memo(e=>{const{minimal:r,onChange:n,feature:{length_min:t,length_max:a,property:s},deviceValue:i}=e,{t:m}=F("common"),[l,c]=f.useState(W(t)),[h,u]=f.useState(!1),[x,g]=f.useState(!1);f.useEffect(()=>{i&&Array.isArray(i)?c(ue(i,t,a,d=>W(d))):c(W(t))},[i,t,a]),f.useEffect(()=>{u(l.length<a),g(l.length>t)},[l,t,a]);const y=f.useCallback((d,b)=>{c(_=>{const p=Array.from(_);return p[d]=b,p})},[]),v=f.useCallback(()=>{c(d=>[...d,"#ffffff"])},[]),S=f.useCallback(d=>{c(b=>{const _=Array.from(b);return _.splice(d,1),_})},[]),N=f.useCallback(()=>n({[s??"gradient"]:l}),[l,s,n]);return o.jsxs(o.Fragment,{children:[l.map((d,b)=>o.jsxs("div",{className:"flex flex-row flex-wrap gap-2 items-center",children:[o.jsx(Oe,{onChange:_=>{y(b,_.hex)},value:{hex:d},format:"hex",minimal:r}),x&&o.jsx(A,{item:b,className:"btn btn-sm btn-error",onClick:S,children:"-"})]},`${d}-${b}`)),h&&o.jsx("div",{className:"flex flex-row flex-wrap gap-2",children:o.jsx(A,{className:"btn btn-sm btn-success",onClick:v,children:"+"})}),o.jsx("div",{children:o.jsx(A,{className:`btn btn-primary ${r?"btn-sm":""}`,onClick:N,children:m(d=>d.apply)})})]})}),Rn={brightness:[0,25,50,75,100].map(e=>({value:Le(e,[0,100],[0,255]),name:`${e}%`})),color_temp:[1e3,2e3,3e3,4e3,5e3,6500].map(e=>({value:1e6/e,name:`${e}K`}))};function En(e){return o.jsx(E,{...e,steps:Rn})}var ee,ye;function kn(){if(ye)return ee;ye=1;function e(r,n,t){var a=-1,s=r.length;n<0&&(n=-n>s?0:s+n),t=t>s?s:t,t<0&&(t+=s),s=n>t?0:t-n>>>0,n>>>=0;for(var i=Array(s);++a<s;)i[a]=r[a+n];return i}return ee=e,ee}var ne,_e;function wn(){if(_e)return ne;_e=1;var e=kn();function r(n,t,a){var s=n.length;return a=a===void 0?s:a,!t&&a>=s?n:e(n,t,a)}return ne=r,ne}var re,ve;function Ge(){if(ve)return re;ve=1;var e="\\ud800-\\udfff",r="\\u0300-\\u036f",n="\\ufe20-\\ufe2f",t="\\u20d0-\\u20ff",a=r+n+t,s="\\ufe0e\\ufe0f",i="\\u200d",m=RegExp("["+i+e+a+s+"]");function l(c){return m.test(c)}return re=l,re}var te,Ce;function In(){if(Ce)return te;Ce=1;function e(r){return r.split("")}return te=e,te}var se,je;function Fn(){if(je)return se;je=1;var e="\\ud800-\\udfff",r="\\u0300-\\u036f",n="\\ufe20-\\ufe2f",t="\\u20d0-\\u20ff",a=r+n+t,s="\\ufe0e\\ufe0f",i="["+e+"]",m="["+a+"]",l="\\ud83c[\\udffb-\\udfff]",c="(?:"+m+"|"+l+")",h="[^"+e+"]",u="(?:\\ud83c[\\udde6-\\uddff]){2}",x="[\\ud800-\\udbff][\\udc00-\\udfff]",g="\\u200d",y=c+"?",v="["+s+"]?",S="(?:"+g+"(?:"+[h,u,x].join("|")+")"+v+y+")*",N=v+y+S,d="(?:"+[h+m+"?",m,u,x,i].join("|")+")",b=RegExp(l+"(?="+l+")|"+d+N,"g");function _(p){return p.match(b)||[]}return se=_,se}var oe,Se;function $n(){if(Se)return oe;Se=1;var e=In(),r=Ge(),n=Fn();function t(a){return r(a)?n(a):e(a)}return oe=t,oe}var ae,Te;function qn(){if(Te)return ae;Te=1;var e=wn(),r=Ge(),n=$n(),t=Ke();function a(s){return function(i){i=t(i);var m=r(i)?n(i):void 0,l=m?m[0]:i.charAt(0),c=m?e(m,1).join(""):i.slice(1);return l[s]()+c}}return ae=a,ae}var ce,Ne;function Mn(){if(Ne)return ce;Ne=1;var e=qn(),r=e("toUpperCase");return ce=r,ce}var le,Ae;function Bn(){if(Ae)return le;Ae=1;var e=Je(),r=Mn(),n=e(function(t,a,s){return t+(s?" ":"")+r(a)});return le=n,le}var Vn=Bn();const On=Re(Vn);function Un(e){return e.type==="composite"&&(e.name==="color_xy"||e.name==="color_hs")}function Gn({children:e,feature:r,deviceValue:n,onRead:t,endpointSpecific:a,parentFeatures:s}){const{t:i}=F("zigbee"),m=r.unit,[l,c]=Ye(r.name,n,m),h=t!==void 0&&(!!(r.property&&r.access&j.GET)||Un(r)),u=s[s.length-1],x=r.name==="state"?r.property:r.name;let g=r.label||On(x);u?.label&&r.name==="state"&&u.type!=="light"&&u.type!=="switch"&&(g=`${u.label} ${r.label.charAt(0).toLowerCase()}${r.label.slice(1)}`);const y=f.useCallback(v=>{v.property&&t?.({[v.property]:""})},[t]);return o.jsxs("div",{className:"list-row p-3",children:[o.jsx("div",{children:o.jsx(ie,{icon:l,className:c,size:"2xl"})}),o.jsxs("div",{children:[o.jsxs("div",{title:x,children:[g,!a&&r.endpoint?` (${i(v=>v.endpoint)}: ${r.endpoint})`:""]}),o.jsx("div",{className:"text-xs font-semibold opacity-60",children:r.description})]}),o.jsx("div",{className:"list-col-wrap flex flex-col gap-2",children:e}),h&&o.jsx(A,{item:r,onClick:y,className:"btn btn-xs btn-square btn-primary btn-soft",children:o.jsx(ie,{icon:De})})]})}function Hn(e){if(e!==void 0){if(e.length===0)return!0;if(e.length===1){const r=e[0].type;return r!=null&&r!=="composite"&&r!=="list"}}return!1}const w=(e,r)=>e>0?Array(e).fill(r==="composite"?{}:""):[],zn=f.memo(e=>{const{t:r}=F("common"),{feature:n,minimal:t,parentFeatures:a,onChange:s,deviceValue:i}=e,{property:m,access:l=j.SET,item_type:c,length_min:h,length_max:u}=n,[x,g]=f.useState(w(h??0,c.type)),[y,v]=f.useState(!1),[S,N]=f.useState(!1),d=Hn(a);f.useEffect(()=>{if(i)if(Array.isArray(i))g(ue(i,h,u,C=>w(C,c.type)));else if(m&&typeof i=="object"){const C=i[m];g(C?ue(C,h,u,T=>w(T,c.type)):w(h??0,c.type))}else g(w(h??0,c.type));else g(w(h??0,c.type))},[i,m,c.type,h,u]),f.useEffect(()=>{v(u!==void 0&&u>0?x.length<u:!0),N(h!==void 0&&h>0?x.length>h:!0)},[x,h,u]);const b=f.useCallback((C,T)=>{const k=Array.from(x);typeof C=="object"&&C!=null&&(C={...x[T],...C}),k[T]=C??"",g(k),d||s(m?{[m]:k}:k)},[x,m,d,s]),_=f.useCallback(()=>g(C=>[...C,c.type==="composite"?{}:""]),[c.type]),p=f.useCallback(C=>{const T=Array.from(x);T.splice(C,1),g(T),d||s(m?{[m]:T}:T)},[x,m,d,s]),$=f.useCallback(()=>{s(m?{[m]:x}:x)},[m,s,x]);return l&j.SET?o.jsxs(o.Fragment,{children:[x.map((C,T)=>o.jsxs("div",{className:"flex flex-row flex-wrap gap-2 items-center",children:[o.jsx(He,{feature:c,device:{},deviceState:C,onChange:k=>b(k,T),featureWrapperClass:Gn,parentFeatures:[...a,n]}),S&&o.jsx(A,{item:T,className:"btn btn-sm btn-error btn-square",onClick:p,children:"-"})]},T)),y&&o.jsx("div",{className:"flex flex-row flex-wrap gap-2",children:o.jsx(A,{className:"btn btn-sm btn-success btn-square",onClick:_,children:"+"})}),d&&o.jsx("div",{children:o.jsx(A,{className:`btn btn-primary ${t?"btn-sm":""}`,onClick:$,children:r(C=>C.apply)})})]}):l&j.STATE?o.jsx(q,{...e}):o.jsx(M,{...e})});function Ln(e){return o.jsx(E,{...e})}const Dn=f.memo(e=>{const{onChange:r,value:n,min:t,max:a,unit:s,steps:i,minimal:m,...l}=e,[c,h]=f.useState(n),u=t!=null&&a!=null;f.useEffect(()=>{h(n)},[n]);const x=f.useCallback(y=>{h(y.target.value?y.target.valueAsNumber:"")},[]),g=f.useCallback(y=>!y.target.validationMessage&&r(c===""?null:c),[c,r]);return o.jsxs("div",{className:"flex flex-row flex-wrap gap-3 items-center",children:[!m&&i?o.jsx(Ue,{values:i,onChange:r,value:c}):null,u?o.jsxs("div",{className:"w-full max-w-xs",children:[o.jsx("input",{min:t,max:a,type:"range",className:"range range-xs range-primary validator",value:c,onChange:x,onTouchEnd:g,onMouseUp:g,onKeyUp:g,...l}),o.jsxs("div",{className:"flex justify-between px-1 mt-1 text-xs",children:[o.jsx("span",{children:t}),m&&o.jsx("span",{children:c}),o.jsx("span",{children:a})]})]}):null,(!m||!u)&&o.jsxs("label",{className:"input",children:[o.jsx("input",{type:"number",className:"grow validator",value:c,onChange:x,onBlur:g,min:t,max:a,...l}),s]})]})}),Pn=f.memo(e=>{const{feature:{presets:r,access:n=j.SET,property:t,unit:a,value_max:s,value_min:i,value_step:m},deviceValue:l,steps:c,onChange:h,minimal:u}=e;return n&j.SET?o.jsx(Dn,{onChange:x=>h(t?{[t]:x}:x),value:typeof l=="number"?l:"",min:i,max:s,step:m,steps:r?.length?r:c,unit:a,minimal:u}):n&j.STATE?o.jsx(q,{...e}):o.jsx(M,{...e})});function Xn(e){return o.jsx(E,{...e})}const Kn=f.memo(e=>{const{onChange:r,value:n,...t}=e,[a,s]=f.useState(n);return f.useEffect(()=>{s(n)},[n]),o.jsx("input",{type:"text",className:"input validator",value:a,onChange:i=>s(i.target.value),onBlur:i=>!i.target.validationMessage&&r(a),...t})}),Jn=f.memo(e=>{const{feature:{access:r=j.SET,property:n},deviceValue:t,onChange:a}=e;return r&j.SET?o.jsx(Kn,{onChange:s=>a(n?{[n]:s}:s),value:t!=null?typeof t=="string"?t:JSON.stringify(t):""}):r&j.STATE?o.jsx(q,{...e}):o.jsx(M,{...e})});function He({feature:e,device:r,deviceState:n,steps:t,onRead:a,onChange:s,featureWrapperClass:i,minimal:m,endpointSpecific:l,parentFeatures:c}){const h=e.property?n[e.property]:n,u=Ee(e),x={device:r,deviceValue:h,onChange:s,onRead:a,featureWrapperClass:i,minimal:m,endpointSpecific:l,parentFeatures:c},g={feature:e,onRead:a,deviceValue:h,parentFeatures:c,endpointSpecific:l};switch(e.type){case"binary":return o.jsx(i,{...g,children:o.jsx(Ze,{feature:e,...x},u)},u);case"numeric":return o.jsx(i,{...g,children:o.jsx(Pn,{feature:e,...x,steps:t},u)},u);case"list":return e.name==="gradient"&&e.length_min!=null&&e.length_max!=null?o.jsx(i,{...g,children:o.jsx(An,{feature:e,...x},u)},u):o.jsx(i,{...g,children:o.jsx(zn,{feature:e,...x},u)},u);case"text":return o.jsx(i,{...g,children:o.jsx(Jn,{feature:e,...x},u)},u);case"enum":return o.jsx(i,{...g,children:o.jsx(Tn,{feature:e,...x},u)},u);case"light":return o.jsx(En,{feature:e,...x,deviceState:n},u);case"switch":return o.jsx(Xn,{feature:e,...x,deviceState:n},u);case"cover":return o.jsx(jn,{feature:e,...x,deviceState:n},u);case"lock":return o.jsx(Ln,{feature:e,...x,deviceState:n},u);case"climate":return o.jsx(We,{feature:e,...x,deviceState:n},u);case"fan":return o.jsx(Nn,{feature:e,...x,deviceState:n},u);case"composite":return e.name==="color_xy"||e.name==="color_hs"?o.jsx(i,{...g,children:o.jsx(vn,{feature:e,...x},u)},u):o.jsx(i,{...g,children:o.jsx(E,{feature:e,...x,deviceState:e.property?n[e.property]:n},u)},u);default:return console.error("Unsupported feature",e),o.jsx(i,{...g,children:o.jsx("pre",{children:JSON.stringify(e,null,4)})},u)}}export{He as F,Gn as a,On as s};
